function F = myfun(x)
p12 = x(1);
p13 = x(2);
p21 = x(3);
p23 = x(4);
p31 = x(5);
p32 = x(6);

P = [sqrt(1-p12^2-p13^2)    p12                     p13
     p21                    sqrt(1-p21^2-p23^2)     p23
     p31                    p32                     sqrt(1-p31^2-p32^2)];
 
k2 = x(7);
k3 = x(8);

K = [1  0   0
     0  k2  0
     0  0   k3];
 
m1 = x(9);
m2 = x(10);
m3 = x(11);

m = [m1 m2 m3]';

invP = inv(P);
invK = inv(K);

% A(1,:,:) = [
%     1   0   0
%     0   1   0
%     0   0   1];

A(1,:,:) = [
    0   0   1
    0   1   0
    -1  0   0];

A(2,:,:) = [
    0   -1  0
    0   0   1
    -1  0   0];

A(3,:,:) = [
    0   0   -1
    0   -1   0
    -1   0   0];

A(4,:,:) = [
    0   1   0
    0   0   -1
    -1   0   0];

A(5,:,:) = [
    0   -1   0
    0   0   -1
    1   0   0];

A(6,:,:) = [
    0   0   1
    0   -1   0
    1   0   0];

A(7,:,:) = [
    0   1   0
    0   0   1
    1   0   0];

A(8,:,:) = [
    0   0   -1
    0   1   0
    1   0   0];

A(9,:,:) = [
    0   -1   0
    1   0   0
    0   0   1];

A(10,:,:) = [
    -1   0   0
    0   -1   0
    0   0   1];

A(11,:,:) = [
    0   1   0
    -1   0   0
    0   0   1];

A(12,:,:) = [
    -1   0   0
    0   0   1
    0   1   0];

A(13,:,:) = [
    0   0   -1
    -1   0   0
    0   1   0];

A(14,:,:) = [
    1   0   0
    0   0   -1
    0   1   0];

A(15,:,:) = [
    0   0   1
    1   0   0
    0   1   0];

A(16,:,:) = [
    1   0   0
    0   0   1
    0   -1   0];

A(17,:,:) = [
    0   0   -1
    1   0   0
    0   -1   0];

A(18,:,:) = [
    -1   0   0
    0   0   -1
    0   -1   0];

A(19,:,:) = [
    0   0   1
    -1   0   0
    0   -1   0];
A(20,:,:) = [
    0   1   0
    1   0   0
    0   0   -1];

A(21,:,:) = [
    0   -1   0
    -1   0   0
    0   0   -1];

M0 = [0.1154   -0.0590   -0.4780]';

M = [
    0.4340   -0.0519    0.0240
    0.4317   -0.1790   -0.0749
    0.4266   -0.0778   -0.1945
    0.4258    0.0518   -0.0994
   -0.4282   -0.1733   -0.0554
   -0.4305   -0.0666    0.0657
   -0.4365    0.0623   -0.0377
   -0.4328   -0.0452   -0.1572
    0.0057   -0.1859   -0.4759
   -0.1279   -0.0828   -0.4610
   -0.0156    0.0516   -0.4733
   -0.1156   -0.4857   -0.0326
    0.0001   -0.4836   -0.1670
    0.1251   -0.4777   -0.0735
    0.0241   -0.4879    0.0566
    0.1166    0.3616   -0.0688
    0.0071    0.3672   -0.2068
   -0.1302    0.3535   -0.0968
   -0.0029    0.3740    0.0163
]';

% plot3(M(1,:), M(2,:), M(3,:), 'o');


for i = 1:19
    for j = 1:3
        for k = 1:3
            Ai(j,k) = A(i,j,k);
        end
    end
    F(i) = (invP*invK*(M0 - m) - Ai'*invP*invK*(M(:,i) - m))' * ...
        (invP*invK*(M0 - m) - Ai'*invP*invK*(M(:,i) - m));
end
end
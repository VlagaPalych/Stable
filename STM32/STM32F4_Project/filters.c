#include "filters.h"
 
// Lowpass filter for ADXL345 accelerometer 
arm_fir_decimate_instance_f32 accel_lpf[3];
float accel_lpf_state[3][ACCEL_FILTER_SIZE + ACCEL_DECIMATION - 1];
float accel_lpf_coeffs[ACCEL_FILTER_SIZE] = {-0.000971251596459908, -7.69406717604047e-05, -6.19799209654469e-05, -3.30906543649738e-05, 1.10814561797306e-05, 7.24805531343648e-05, 0.000152598071257586, 0.000253698805736882, 0.000377317468335945, 0.000525701202486072, 0.000700518195310734, 0.000903997339458505, 0.00113739692160716, 0.00140312152077752, 0.00170195103075679, 0.00203566452362004, 0.00240546060485815, 0.00281231733030840, 0.00325638090562598, 0.00373853563596467, 0.00425842477132322, 0.00481595944431221, 0.00541027647136111, 0.00604061130952030, 0.00670524975565512, 0.00740308239924367, 0.00813154544121787, 0.00888873230285860, 0.00967096533068780, 0.0104756034830591, 0.0112971993347504, 0.0121352733530491, 0.0129849453923593, 0.0138385519287171, 0.0146955841292333, 0.0155486053454725, 0.0163942550438339, 0.0172263771763229, 0.0180408483356263, 0.0188316697226914, 0.0195946307655523, 0.0203241247156848, 0.0210158009852968, 0.0216645459211678, 0.0222667388005664, 0.0228165591799628, 0.0233122609941272, 0.0237489436996918, 0.0241240737240030, 0.0244343475043236, 0.0246784705527375, 0.0248538046118870, 0.0249598963537244, 0.0249951385161779, 0.0249598963537244, 0.0248538046118870, 0.0246784705527375, 0.0244343475043236, 0.0241240737240030, 0.0237489436996918, 0.0233122609941272, 0.0228165591799628, 0.0222667388005664, 0.0216645459211678, 0.0210158009852968, 0.0203241247156848, 0.0195946307655523, 0.0188316697226914, 0.0180408483356263, 0.0172263771763229, 0.0163942550438339, 0.0155486053454725, 0.0146955841292333, 0.0138385519287171, 0.0129849453923593, 0.0121352733530491, 0.0112971993347504, 0.0104756034830591, 0.00967096533068780, 0.00888873230285860, 0.00813154544121787, 0.00740308239924367, 0.00670524975565512, 0.00604061130952030, 0.00541027647136111, 0.00481595944431221, 0.00425842477132322, 0.00373853563596467, 0.00325638090562598, 0.00281231733030840, 0.00240546060485815, 0.00203566452362004, 0.00170195103075679, 0.00140312152077752, 0.00113739692160716, 0.000903997339458505, 0.000700518195310734, 0.000525701202486072, 0.000377317468335945, 0.000253698805736882, 0.000152598071257586, 7.24805531343648e-05, 1.10814561797306e-05, -3.30906543649738e-05, -6.19799209654469e-05, -7.69406717604047e-05, -0.000971251596459908};;
float accel_history[3][2*ACCEL_FILTER_SIZE];
uint8_t accel_history_index = 0;
uint8_t accel_history_filter_index = 0;
float filtered_a[3];
    
    
// Lowpass filter for ADXRS453 ars
arm_fir_decimate_instance_f32 adxrs453_lpf;
float adxrs453_lpf_state[ADXRS453_FILTER_SIZE + ADXRS453_DECIMATION - 1];
float adxrs453_lpf_coeffs[ADXRS453_FILTER_SIZE] = {0.000765996615305244, 0.000660820151020175, 0.000904398442903659, 0.00116993648900164, 0.00144225289999618, 0.00170146983193675, 0.00192506416920931, 0.00208637960406920, 0.00215549334724139, 0.00210628189455340, 0.00190929130872978, 0.00154175764366672, 0.000985379572064331, 0.000231037660150656, -0.000720975242728358, -0.00185800385190914, -0.00315400290658119, -0.00456986885279512, -0.00605129658439567, -0.00753137446367871, -0.00893102356144855, -0.0101624543586776, -0.0111314200131555, -0.0117417714988076, -0.0118994911274908, -0.0115170351071913, -0.0105188708579065, -0.00884554022866118, -0.00645838490726134, -0.00334261386423469, 0.000489473606544453, 0.00499731904300335, 0.0101115226151986, 0.0157346375919648, 0.0217436975271735, 0.0279935671243145, 0.0343218642376052, 0.0405544117337099, 0.0465120006171619, 0.0520171194154150, 0.0569010809190037, 0.0610109684009580, 0.0642158515277905, 0.0664123296154894, 0.0675288324909505, 0.0675288324909505, 0.0664123296154894, 0.0642158515277905, 0.0610109684009580, 0.0569010809190037, 0.0520171194154150, 0.0465120006171619, 0.0405544117337099, 0.0343218642376052, 0.0279935671243145, 0.0217436975271735, 0.0157346375919648, 0.0101115226151986, 0.00499731904300335, 0.000489473606544453, -0.00334261386423469, -0.00645838490726134, -0.00884554022866118, -0.0105188708579065, -0.0115170351071913, -0.0118994911274908, -0.0117417714988076, -0.0111314200131555, -0.0101624543586776, -0.00893102356144855, -0.00753137446367871, -0.00605129658439567, -0.00456986885279512, -0.00315400290658119, -0.00185800385190914, -0.000720975242728358, 0.000231037660150656, 0.000985379572064331, 0.00154175764366672, 0.00190929130872978, 0.00210628189455340, 0.00215549334724139, 0.00208637960406920, 0.00192506416920931, 0.00170146983193675, 0.00144225289999618, 0.00116993648900164, 0.000904398442903659, 0.000660820151020175, 0.000765996615305244};;
float adxrs453_history[2*ADXRS453_FILTER_SIZE];
uint8_t adxrs453_history_index = 0;
uint8_t adxrs453_history_filter_index = 0;
float filtered_arz;
    
    
// Lowpass filter for ADXRS290 ars's
arm_fir_decimate_instance_f32 adxrs290_lpf[2];
float adxrs290_lpf_state[2][ADXRS290_FILTER_SIZE + ADXRS290_DECIMATION - 1];
float adxrs290_lpf_coeffs[] = {0.00501118553802371, -0.00179841043427587, -0.00154684600420296, -0.00135734630748630, -0.00121872872114182, -0.00111846416257322, -0.00105052487924695, -0.00100636633578688, -0.000982847879640758, -0.000973849382717162, -0.000978462514467537, -0.000991863198578358, -0.00101419829297811, -0.00104169792030007, -0.00107517489232123, -0.00111139193177223, -0.00115198176354170, -0.00119361816905439, -0.00123829569201916, -0.00128299521747977, -0.00132998963817954, -0.00137622200418264, -0.00142427720129490, -0.00147075904533267, -0.00151859782636166, -0.00156439817510545, -0.00161138025578111, -0.00165551551617682, -0.00170083320699632, -0.00174244097433984, -0.00178558076731861, -0.00182397908065468, -0.00186494854278862, -0.00189820374362171, -0.00193750008475035, -0.00196674745529890, -0.00199432554654777, -0.00203146762214601, -0.00204955344088376, -0.00207081343978643, -0.00209121732041240, -0.00211141840554774, -0.00212380057200789, -0.00213233241811395, -0.00213620532304049, -0.00213921885006130, -0.00213888473808765, -0.00213544769212604, -0.00212630466558039, -0.00211263424716890, -0.00209332397207618, -0.00207018596120179, -0.00204264535568655, -0.00201124791055918, -0.00197529024444520, -0.00193476094864309, -0.00188879109919071, -0.00183741608634591, -0.00178023078478873, -0.00171751249581575, -0.00164933968335390, -0.00157606112770736, -0.00149748462717980, -0.00141364312730730, -0.00132453918922693, -0.00122982368338853, -0.00112972059287131, -0.00102340115699917, -0.000911886629182845, -0.000792780192568898, -0.000670889916364104, -0.000539430126082152, -0.000405123195378110, -0.000265389593550935, -0.000117689691251144, 3.35884324158542e-05, 0.000189614496775903, 0.000351468916051090, 0.000519603490829468, 0.000692266621626914, 0.000869743817020208, 0.00105199380777776, 0.00123999791685492, 0.00143325212411582, 0.00163114035967737, 0.00183275341987610, 0.00203894940204918, 0.00224916590377688, 0.00246399384923279, 0.00268279714509845, 0.00290503189899027, 0.00313040427863598, 0.00335881602950394, 0.00359022105112672, 0.00382454227656126, 0.00406152429059148, 0.00430088536813855, 0.00454221712425351, 0.00478552421554923, 0.00503016449511051, 0.00527625484392047, 0.00552326347678900, 0.00577158993110061, 0.00602038111537695, 0.00626991409808397, 0.00651950109750032, 0.00676779868081212, 0.00701727718114853, 0.00726404832676053, 0.00751061458140612, 0.00775588583201170, 0.00799916964024305, 0.00824034679681063, 0.00848015490919352, 0.00871717743575573, 0.00895121414214373, 0.00918190274387598, 0.00940938573330641, 0.00963314250111580, 0.00985319912433624, 0.0100684780627489, 0.0102794291451573, 0.0104862460866570, 0.0106878373771906, 0.0108843445777893, 0.0110750822350383, 0.0112599348649383, 0.0114390701055527, 0.0116119431331754, 0.0117783918976784, 0.0119377626106143, 0.0120902946218848, 0.0122356330975890, 0.0123740844428539, 0.0125051895156503, 0.0126287108287215, 0.0127443587407470, 0.0128520121797919, 0.0129517428576946, 0.0130429118871689, 0.0131260985508561, 0.0132003771141171, 0.0132662327960134, 0.0133242271840572, 0.0133725376799703, 0.0134126702323556, 0.0134436674416065, 0.0134659400209785, 0.0134792160242796, 0.0134839843958616, 0.0134792160242796, 0.0134659400209785, 0.0134436674416065, 0.0134126702323556, 0.0133725376799703, 0.0133242271840572, 0.0132662327960134, 0.0132003771141171, 0.0131260985508561, 0.0130429118871689, 0.0129517428576946, 0.0128520121797919, 0.0127443587407470, 0.0126287108287215, 0.0125051895156503, 0.0123740844428539, 0.0122356330975890, 0.0120902946218848, 0.0119377626106143, 0.0117783918976784, 0.0116119431331754, 0.0114390701055527, 0.0112599348649383, 0.0110750822350383, 0.0108843445777893, 0.0106878373771906, 0.0104862460866570, 0.0102794291451573, 0.0100684780627489, 0.00985319912433624, 0.00963314250111580, 0.00940938573330641, 0.00918190274387598, 0.00895121414214373, 0.00871717743575573, 0.00848015490919352, 0.00824034679681063, 0.00799916964024305, 0.00775588583201170, 0.00751061458140612, 0.00726404832676053, 0.00701727718114853, 0.00676779868081212, 0.00651950109750032, 0.00626991409808397, 0.00602038111537695, 0.00577158993110061, 0.00552326347678900, 0.00527625484392047, 0.00503016449511051, 0.00478552421554923, 0.00454221712425351, 0.00430088536813855, 0.00406152429059148, 0.00382454227656126, 0.00359022105112672, 0.00335881602950394, 0.00313040427863598, 0.00290503189899027, 0.00268279714509845, 0.00246399384923279, 0.00224916590377688, 0.00203894940204918, 0.00183275341987610, 0.00163114035967737, 0.00143325212411582, 0.00123999791685492, 0.00105199380777776, 0.000869743817020208, 0.000692266621626914, 0.000519603490829468, 0.000351468916051090, 0.000189614496775903, 3.35884324158542e-05, -0.000117689691251144, -0.000265389593550935, -0.000405123195378110, -0.000539430126082152, -0.000670889916364104, -0.000792780192568898, -0.000911886629182845, -0.00102340115699917, -0.00112972059287131, -0.00122982368338853, -0.00132453918922693, -0.00141364312730730, -0.00149748462717980, -0.00157606112770736, -0.00164933968335390, -0.00171751249581575, -0.00178023078478873, -0.00183741608634591, -0.00188879109919071, -0.00193476094864309, -0.00197529024444520, -0.00201124791055918, -0.00204264535568655, -0.00207018596120179, -0.00209332397207618, -0.00211263424716890, -0.00212630466558039, -0.00213544769212604, -0.00213888473808765, -0.00213921885006130, -0.00213620532304049, -0.00213233241811395, -0.00212380057200789, -0.00211141840554774, -0.00209121732041240, -0.00207081343978643, -0.00204955344088376, -0.00203146762214601, -0.00199432554654777, -0.00196674745529890, -0.00193750008475035, -0.00189820374362171, -0.00186494854278862, -0.00182397908065468, -0.00178558076731861, -0.00174244097433984, -0.00170083320699632, -0.00165551551617682, -0.00161138025578111, -0.00156439817510545, -0.00151859782636166, -0.00147075904533267, -0.00142427720129490, -0.00137622200418264, -0.00132998963817954, -0.00128299521747977, -0.00123829569201916, -0.00119361816905439, -0.00115198176354170, -0.00111139193177223, -0.00107517489232123, -0.00104169792030007, -0.00101419829297811, -0.000991863198578358, -0.000978462514467537, -0.000973849382717162, -0.000982847879640758, -0.00100636633578688, -0.00105052487924695, -0.00111846416257322, -0.00121872872114182, -0.00135734630748630, -0.00154684600420296, -0.00179841043427587, 0.00501118553802371};    
float adxrs290_history[2][2*ADXRS290_FILTER_SIZE];
uint16_t adxrs290_history_index = 0;
uint16_t adxrs290_history_filter_index = 0;
float filtered_ar[2];    

uint8_t adxrs290_lowpass_ready = 0;
uint8_t adxrs290_process_index = 0;
uint8_t adxrs290_do_process = 0;
    
    
//// Highpass filter (0.5 Hz) for LPF(RECT(HPF())) procedure
//arm_fir_instance_f32 quasistatic_hpf;
//float quasistatic_hpf_state[QUASISTATIC_HPF_SIZE];
//float quasistatic_hpf_coeffs[QUASISTATIC_HPF_SIZE] = {0.00585181933433571, -0.00462586937568031, -0.00328051893500109, -0.00241705067562204, -0.00186806373477786, -0.00152382592336072, -0.00131364935926357, -0.00119073468873485, -0.00112516719930708, -0.00109703661238069, -0.00109392111309537, -0.00110726803896998, -0.00113157731312410, -0.00116336333268690, -0.00120053866621515, -0.00124079548516838, -0.00128392262890449, -0.00132906080249205, -0.00137539291379402, -0.00142362316327422, -0.00147245768378029, -0.00152279199651736, -0.00157372472331593, -0.00162535892336040, -0.00167797643170699, -0.00173130155709045, -0.00178539172129656, -0.00184033289498110, -0.00189522475991157, -0.00195157261828679, -0.00200792687564788, -0.00206575874071808, -0.00212322336605970, -0.00218267039307920, -0.00224075461468880, -0.00230178106102958, -0.00235889242742064, -0.00242458248375187, -0.00247704540836852, -0.00254911422011962, -0.00260420789853630, -0.00266384209683066, -0.00273631188485554, -0.00279425514795141, -0.00285444600437210, -0.00291992459835739, -0.00298901331725258, -0.00305085002912419, -0.00311251022293625, -0.00317569505231909, -0.00324408067569441, -0.00331099395619217, -0.00337685325622966, -0.00343901261673680, -0.00350352831728961, -0.00356920693609141, -0.00363690336317831, -0.00370364951162383, -0.00376958624027858, -0.00383292317039080, -0.00389753906039077, -0.00396131269166266, -0.00402778380864744, -0.00409322216780023, -0.00415949604881318, -0.00422395662366088, -0.00428797141181722, -0.00435054962859004, -0.00441338091655635, -0.00447588775146248, -0.00453944509749996, -0.00460263727214331, -0.00466534270656141, -0.00472755798304421, -0.00478814362629348, -0.00484920103201325, -0.00490682177643547, -0.00496577426310581, -0.00502364670407500, -0.00507917242724779, -0.00513965484553513, -0.00519382864223092, -0.00525117764111644, -0.00530743239155232, -0.00536184199502549, -0.00541289031118241, -0.00546640323861235, -0.00551716539813259, -0.00556673304195867, -0.00561421321883140, -0.00566367283138243, -0.00571063754320424, -0.00575760192617135, -0.00580253549380465, -0.00584795045171858, -0.00589230867853246, -0.00593632091983364, -0.00597594480339487, -0.00601651817921886, -0.00605407898096535, -0.00609286246585123, -0.00612854433883352, -0.00616343663017517, -0.00619583212616978, -0.00622810766394482, -0.00625903418963496, -0.00628968922011037, -0.00631759498527619, -0.00634448467626678, -0.00636904756071890, -0.00639344049977891, -0.00641649240517365, -0.00643855438450521, -0.00645870050567083, -0.00647775671835647, -0.00649456612418044, -0.00651127450705056, -0.00652343361303491, -0.00653785867738924, -0.00654791157252158, -0.00655871818523917, -0.00656669610502036, -0.00657328369126339, -0.00657791044750335, -0.00658332654393323, -0.00658456076047614, 0.993414564092643, -0.00658456076047614, -0.00658332654393323, -0.00657791044750335, -0.00657328369126339, -0.00656669610502036, -0.00655871818523917, -0.00654791157252158, -0.00653785867738924, -0.00652343361303491, -0.00651127450705056, -0.00649456612418044, -0.00647775671835647, -0.00645870050567083, -0.00643855438450521, -0.00641649240517365, -0.00639344049977891, -0.00636904756071890, -0.00634448467626678, -0.00631759498527619, -0.00628968922011037, -0.00625903418963496, -0.00622810766394482, -0.00619583212616978, -0.00616343663017517, -0.00612854433883352, -0.00609286246585123, -0.00605407898096535, -0.00601651817921886, -0.00597594480339487, -0.00593632091983364, -0.00589230867853246, -0.00584795045171858, -0.00580253549380465, -0.00575760192617135, -0.00571063754320424, -0.00566367283138243, -0.00561421321883140, -0.00556673304195867, -0.00551716539813259, -0.00546640323861235, -0.00541289031118241, -0.00536184199502549, -0.00530743239155232, -0.00525117764111644, -0.00519382864223092, -0.00513965484553513, -0.00507917242724779, -0.00502364670407500, -0.00496577426310581, -0.00490682177643547, -0.00484920103201325, -0.00478814362629348, -0.00472755798304421, -0.00466534270656141, -0.00460263727214331, -0.00453944509749996, -0.00447588775146248, -0.00441338091655635, -0.00435054962859004, -0.00428797141181722, -0.00422395662366088, -0.00415949604881318, -0.00409322216780023, -0.00402778380864744, -0.00396131269166266, -0.00389753906039077, -0.00383292317039080, -0.00376958624027858, -0.00370364951162383, -0.00363690336317831, -0.00356920693609141, -0.00350352831728961, -0.00343901261673680, -0.00337685325622966, -0.00331099395619217, -0.00324408067569441, -0.00317569505231909, -0.00311251022293625, -0.00305085002912419, -0.00298901331725258, -0.00291992459835739, -0.00285444600437210, -0.00279425514795141, -0.00273631188485554, -0.00266384209683066, -0.00260420789853630, -0.00254911422011962, -0.00247704540836852, -0.00242458248375187, -0.00235889242742064, -0.00230178106102958, -0.00224075461468880, -0.00218267039307920, -0.00212322336605970, -0.00206575874071808, -0.00200792687564788, -0.00195157261828679, -0.00189522475991157, -0.00184033289498110, -0.00178539172129656, -0.00173130155709045, -0.00167797643170699, -0.00162535892336040, -0.00157372472331593, -0.00152279199651736, -0.00147245768378029, -0.00142362316327422, -0.00137539291379402, -0.00132906080249205, -0.00128392262890449, -0.00124079548516838, -0.00120053866621515, -0.00116336333268690, -0.00113157731312410, -0.00110726803896998, -0.00109392111309537, -0.00109703661238069, -0.00112516719930708, -0.00119073468873485, -0.00131364935926357, -0.00152382592336072, -0.00186806373477786, -0.00241705067562204, -0.00328051893500109, -0.00462586937568031, 0.00585181933433571};
//float accel_modulo_history[2*QUASISTATIC_HPF_SIZE];
//uint16_t accel_modulo_history_index = 0;
//    
//    
//// Lowpass filter (0.5 Hz) for LPF(RECT(HPF())) procedure
//arm_fir_instance_f32 quasistatic_lpf;
//float quasistatic_lpf_state[QUASISTATIC_LPF_SIZE];
//float quasistatic_lpf_coeffs[QUASISTATIC_LPF_SIZE] = {0.00872931973870739, 0.000803878864790022, 0.000841295149222671, 0.000877087888832270, 0.000915927740573069, 0.000953534058454849, 0.000994573466619443, 0.00103461893163067, 0.00107798898702800, 0.00111964623086510, 0.00116365104897034, 0.00120445226861276, 0.00124642937483987, 0.00128596011484473, 0.00133261897430165, 0.00139410980226614, 0.00142869987487724, 0.00147912740051741, 0.00152893101480007, 0.00157681484376340, 0.00162741677704713, 0.00167624423169543, 0.00172814788661838, 0.00177871805894595, 0.00183248365459938, 0.00188484172566901, 0.00193932917685560, 0.00199106262860067, 0.00204449121668123, 0.00209780624369112, 0.00215761805782936, 0.00220814841818056, 0.00226677276036820, 0.00232213980929682, 0.00238015344932774, 0.00243637752740267, 0.00249480550074114, 0.00255150193898589, 0.00261060477622228, 0.00266831990955295, 0.00272880920758596, 0.00278743913664420, 0.00284781232205742, 0.00290572609962523, 0.00296666173692769, 0.00302712568231277, 0.00308620437982194, 0.00314625365734822, 0.00320726086436585, 0.00326668982329445, 0.00332798736550885, 0.00338724707777274, 0.00344816877444284, 0.00350700105860559, 0.00356762063522794, 0.00362668591765092, 0.00368731101099151, 0.00374585137310842, 0.00380544105662142, 0.00386384465535500, 0.00392417214334451, 0.00398065312769627, 0.00404012603231153, 0.00409689730879161, 0.00415515261219407, 0.00421155268829390, 0.00426904538801955, 0.00432458417294572, 0.00438090049152083, 0.00443528873399293, 0.00449078267147059, 0.00454423284150036, 0.00459837402458583, 0.00465016346401114, 0.00470328543434906, 0.00475461268468712, 0.00480532345279493, 0.00485517480553789, 0.00490480124647979, 0.00495260992947266, 0.00500080144273950, 0.00504703454430255, 0.00509357583112381, 0.00513793990554942, 0.00518251242367235, 0.00522527873568225, 0.00526801988131811, 0.00530874530417354, 0.00534905880617471, 0.00538803215421511, 0.00542689280775331, 0.00546308968469504, 0.00549995234169018, 0.00553433258128510, 0.00556852673873854, 0.00560079965679547, 0.00563270396862189, 0.00566278216627249, 0.00569216478310479, 0.00571976689152579, 0.00574693383224174, 0.00577222050289899, 0.00579682825410129, 0.00581923675091297, 0.00584145070802516, 0.00586174917680499, 0.00588070888457273, 0.00589868634469054, 0.00591525244468611, 0.00593025506660678, 0.00594420030715826, 0.00595658062475419, 0.00596789372380975, 0.00597739800150256, 0.00598577614591468, 0.00599273539692848, 0.00599841243590329, 0.00600267221297554, 0.00600518864273078, 0.00600688906688161, 0.00600688906688161, 0.00600518864273078, 0.00600267221297554, 0.00599841243590329, 0.00599273539692848, 0.00598577614591468, 0.00597739800150256, 0.00596789372380975, 0.00595658062475419, 0.00594420030715826, 0.00593025506660678, 0.00591525244468611, 0.00589868634469054, 0.00588070888457273, 0.00586174917680499, 0.00584145070802516, 0.00581923675091297, 0.00579682825410129, 0.00577222050289899, 0.00574693383224174, 0.00571976689152579, 0.00569216478310479, 0.00566278216627249, 0.00563270396862189, 0.00560079965679547, 0.00556852673873854, 0.00553433258128510, 0.00549995234169018, 0.00546308968469504, 0.00542689280775331, 0.00538803215421511, 0.00534905880617471, 0.00530874530417354, 0.00526801988131811, 0.00522527873568225, 0.00518251242367235, 0.00513793990554942, 0.00509357583112381, 0.00504703454430255, 0.00500080144273950, 0.00495260992947266, 0.00490480124647979, 0.00485517480553789, 0.00480532345279493, 0.00475461268468712, 0.00470328543434906, 0.00465016346401114, 0.00459837402458583, 0.00454423284150036, 0.00449078267147059, 0.00443528873399293, 0.00438090049152083, 0.00432458417294572, 0.00426904538801955, 0.00421155268829390, 0.00415515261219407, 0.00409689730879161, 0.00404012603231153, 0.00398065312769627, 0.00392417214334451, 0.00386384465535500, 0.00380544105662142, 0.00374585137310842, 0.00368731101099151, 0.00362668591765092, 0.00356762063522794, 0.00350700105860559, 0.00344816877444284, 0.00338724707777274, 0.00332798736550885, 0.00326668982329445, 0.00320726086436585, 0.00314625365734822, 0.00308620437982194, 0.00302712568231277, 0.00296666173692769, 0.00290572609962523, 0.00284781232205742, 0.00278743913664420, 0.00272880920758596, 0.00266831990955295, 0.00261060477622228, 0.00255150193898589, 0.00249480550074114, 0.00243637752740267, 0.00238015344932774, 0.00232213980929682, 0.00226677276036820, 0.00220814841818056, 0.00215761805782936, 0.00209780624369112, 0.00204449121668123, 0.00199106262860067, 0.00193932917685560, 0.00188484172566901, 0.00183248365459938, 0.00177871805894595, 0.00172814788661838, 0.00167624423169543, 0.00162741677704713, 0.00157681484376340, 0.00152893101480007, 0.00147912740051741, 0.00142869987487724, 0.00139410980226614, 0.00133261897430165, 0.00128596011484473, 0.00124642937483987, 0.00120445226861276, 0.00116365104897034, 0.00111964623086510, 0.00107798898702800, 0.00103461893163067, 0.000994573466619443, 0.000953534058454849, 0.000915927740573069, 0.000877087888832270, 0.000841295149222671, 0.000803878864790022, 0.00872931973870739};
//float accel_modulo_highpassed_history[2*QUASISTATIC_LPF_SIZE];
//uint16_t accel_modulo_highpassed_history_index = 0;